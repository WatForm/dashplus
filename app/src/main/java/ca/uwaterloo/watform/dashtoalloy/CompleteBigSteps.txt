/*
 * completeBigStepsFact
 *
 * Every non-stable snapshot included in the next snapshot relation 
 * has a next snapshot, which means every big step must be complete.
 * fact completeBigSteps { 
 *      all s : Snapshot | s.stable == False 
 *			=> some s': Snapshot. small_step[s,s']
 * }
 *
 * The above works for all methods.
 */

package ca.uwaterloo.watform.dashtoalloy;

package ca.uwaterloo.watform.dashtoalloy;

import static ca.uwaterloo.watform.utils.GeneralUtil.*;

import ca.uwaterloo.watform.alloyast.expr.AlloyExpr;
import ca.uwaterloo.watform.alloyast.expr.misc.AlloyDecl;
import ca.uwaterloo.watform.alloyast.paragraph.sig.AlloySigPara;
import ca.uwaterloo.watform.dashast.DashStrings;
import ca.uwaterloo.watform.dashmodel.DashFQN;
import ca.uwaterloo.watform.dashmodel.DashModel;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class CompleteBigSteps extends SpaceSignatures {

public class CompleteBigSteps {

	public static void addCompleteBigSteps(DashModule d) {
		if (d.hasConcurrency()) {
			Expr b = createAll(curDecls(),
						createImplies(
							curStableFalse(),
							createSome(nextDecls(), 
								createPredCall(DashStrings.smallStepName, curNextVars()))));

			List<Expr> body = new ArrayList<Expr>();
			body.add(b);
			this.dm.addFactSimple(
				DashStrings.completeBigStepsName, body);
		}
	}
}
